# ุฏููู ุฅุนุฏุงุฏ Supabase ูุชุฎุฒูู ุงูุตูุฑ
## Supabase Integration Setup Guide

ูุฐุง ุงูุฏููู ูุดุฑุญ ููููุฉ ุฑุจุท ุงููุดุฑูุน ุจูุงุนุฏุฉ ุจูุงูุงุช Supabase ูุฅุนุฏุงุฏ ุชุฎุฒูู ุงูุตูุฑ ูููุญุฉ ุงูุชุญูู ุงูุฅุฏุงุฑูุฉ.

## ๐ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

### 1. ุฅูุดุงุก ูุดุฑูุน Supabase ุฌุฏูุฏ
1. ุงุฐูุจ ุฅูู [Supabase Dashboard](https://supabase.com/dashboard/projects)
2. ูู ุจุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ ุฃู ุงุณุชุฎุฏู ุงููุดุฑูุน ุงูููุฌูุฏ
3. ุงูุชุธุฑ ุญุชู ูุชู ุฅูุดุงุก ุงููุดุฑูุน ุจุงููุงูู

### 2. ุงูุญุตูู ุนูู ุจูุงูุงุช ุงูุงุชุตุงู
1. ูู ุตูุญุฉ ุงููุดุฑูุนุ ุงููุฑ ุนูู "Connect" ูู ุดุฑูุท ุงูุฃุฏูุงุช ุงูุนููู
2. ุงูุณุฎ ูููุฉ URI ุชุญุช "Connection string" โ "Transaction pooler"
3. ุงุณุชุจุฏู `[YOUR-PASSWORD]` ุจูููุฉ ูุฑูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุชู ุญุฏุฏุชูุง

### 3. ุงูุญุตูู ุนูู ููุงุชูุญ API
1. ุงุฐูุจ ุฅูู "Settings" โ "API"
2. ุงูุณุฎ ุงูููู ุงูุชุงููุฉ:
   - `Project URL` (SUPABASE_URL)
   - `anon/public` key (SUPABASE_ANON_KEY)
   - `service_role/secret` key (SUPABASE_SERVICE_ROLE_KEY)

## ๐ง ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ูุฌุจ ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ุงูุชุงููุฉ ูู Replit Secrets:

```env
# ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ (ููุฌูุฏุฉ ูุณุจูุงู)
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.ruozmtobogmwprpnpjmj.supabase.co:5432/postgres

# ูุชุบูุฑุงุช Supabase Storage
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
```

### ุฅุถุงูุฉ Secrets ูู Replit:
1. ุงููุฑ ุนูู ููู ุงูุฃูุงู ๐ ูู ุงูุดุฑูุท ุงูุฌุงูุจู
2. ุงููุฑ "Add Secret"
3. ุฃุถู ูู ูุชุบูุฑ ุนูู ุญุฏุฉ:
   - `SUPABASE_URL`
   - `SUPABASE_ANON_KEY`
   - `SUPABASE_SERVICE_ROLE_KEY`

## ๐๏ธ ุฅุนุฏุงุฏ Storage Bucket

### 1. ุฅูุดุงุก Bucket ููุตูุฑ
1. ุงุฐูุจ ุฅูู "Storage" ูู Supabase Dashboard
2. ุงููุฑ "Create Bucket"
3. ุงุณู ุงูู Bucket: `restaurant-images`
4. ูุนู "Public bucket" ุฅุฐุง ููุช ุชุฑูุฏ ุงูุตูุฑ ูุชุงุญุฉ ููุฌูููุฑ

### 2. ุฅุนุฏุงุฏ Storage Policies (RLS)
ูู ุจุชูููุฐ ุงูููุฏ ุงูุชุงูู ูู SQL Editor:

```sql
-- ุงูุณูุงุญ ุจุฑูุน ุงูุตูุฑ (Public Upload Policy)
INSERT INTO storage.policies (id, bucket_id, name, definition, check)
VALUES (
  'allow-public-uploads',
  'restaurant-images',
  'Allow public uploads',
  'true',
  'true'
);

-- ุงูุณูุงุญ ุจุงููุตูู ููุตูุฑ (Public Access Policy)
INSERT INTO storage.policies (id, bucket_id, name, definition, check)
VALUES (
  'allow-public-access',
  'restaurant-images', 
  'Allow public access',
  'true',
  'true'
);
```

### 3. ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ ููู Bucket
```sql
-- ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูู Bucket ูุชููู ุนุงูุฉ
UPDATE storage.buckets 
SET public = true 
WHERE id = 'restaurant-images';
```

## ๐๏ธ ูููู ุงููุธุงู ุงูููุญุฏุซ

### ุงููููุงุช ุงูููุถุงูุฉ ูุงูููุญุฏุซุฉ:

#### 1. Backend Files:
- **`server/supabase.ts`** - ุฅุนุฏุงุฏ ุนููู Supabase
- **`server/routes/upload.ts`** - ูุณุงุฑุงุช ุฑูุน ุงูุตูุฑ
- **`server/routes.ts`** - ุชุญุฏูุซ ูุฅุถุงูุฉ ูุณุงุฑุงุช ุงูุฑูุน

#### 2. Frontend Components:
- **`client/src/components/ImageUpload.tsx`** - ูููู ุฑูุน ุงูุตูุฑ
- **`client/src/pages/AdminRestaurants.tsx`** - ุชุญุฏูุซ ูููุฐุฌ ุงููุทุงุนู
- **`client/src/pages/AdminMenuItems.tsx`** - ุชุญุฏูุซ ูููุฐุฌ ุงููุฌุจุงุช

#### 3. Dependencies ุงูููุถุงูุฉ:
```json
{
  "@supabase/supabase-js": "^2.x.x",
  "multer": "^1.x.x",
  "base64-arraybuffer": "^2.x.x",
  "@types/multer": "^1.x.x"
}
```

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูู ููุญุฉ ุงูุชุญูู ุงูุฅุฏุงุฑูุฉ:
1. ุงุฐูุจ ุฅูู "ุฅุฏุงุฑุฉ ุงููุทุงุนู" ุฃู "ุฅุฏุงุฑุฉ ุงููุฌุจุงุช"
2. ุฃููุฑ "ุฅุถุงูุฉ ุฌุฏูุฏ" ุฃู "ุชุนุฏูู"
3. ูู ูุณู ุงูุตูุฑุฉุ ุงููุฑ ุนูู ููุทูุฉ ุงูุฑูุน
4. ุงุฎุชุฑ ุตูุฑุฉ ูู ุฌูุงุฒู (ุญุฏ ุฃูุตู 10 ููุฌุงุจุงูุช)
5. ุณูุชู ุฑูุน ุงูุตูุฑุฉ ุชููุงุฆูุงู ุฅูู Supabase Storage
6. ุณูุชู ุญูุธ ุฑุงุจุท ุงูุตูุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 2. API Endpoints ุงูุฌุฏูุฏุฉ:
- **`POST /api/upload/image`** - ุฑูุน ุตูุฑุฉ ูุงุญุฏุฉ
- **`POST /api/upload/images`** - ุฑูุน ุนุฏุฉ ุตูุฑ
- **`DELETE /api/upload/image`** - ุญุฐู ุตูุฑุฉ

## ๐ ุงูุฃูุงู ูุงูุญูุงูุฉ

### 1. ุชุญุฏูุฏ ุฃููุงุน ุงููููุงุช:
- ููุจู ุงููุธุงู ุงูุตูุฑ ููุท (image/*)
- ุญุฏ ุฃูุตู ููุญุฌู: 10 ููุฌุงุจุงูุช
- ููุชุฑุฉ ุฃูููุฉ ูููููุงุช ุงูุถุงุฑุฉ

### 2. ุงูุชุญูู ูู ุงูุตุญุฉ:
- ุงูุชุญูู ูู ููุน ุงูููู ูู ุงูุฎุงุฏู
- ุงูุชุญูู ูู ุญุฌู ุงูููู
- ุชุณููุฉ ูุฑูุฏุฉ ูููููุงุช ูุชุฌูุจ ุงูุชุนุงุฑุถ

### 3. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ
- ุชุณุฌูู ููุตู ููุฃุฎุทุงุก
- ุขููุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุญููุง

### ุฎุทุฃ ูู ุงูุงุชุตุงู ุจู Supabase:
1. ุชุฃูุฏ ูู ุตุญุฉ SUPABASE_URL
2. ุชุฃูุฏ ูู ุตุญุฉ ููุงุชูุญ API
3. ุชุฃูุฏ ูู ุฃู ุงููุดุฑูุน ูุดุท ููุนูู

### ุฎุทุฃ ูู ุฑูุน ุงูุตูุฑ:
1. ุชุฃูุฏ ูู ุฅูุดุงุก `restaurant-images` bucket
2. ุชุฃูุฏ ูู ุชูุนูู Public Access
3. ุชุฃูุฏ ูู Storage Policies

### ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
1. ุชุฃูุฏ ูู DATABASE_URL ุตุญูุญ
2. ุชุฃูุฏ ูู ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุตูุฉ
3. ุชุดุบูู `npm run db:push` ููุฒุงููุฉ ุงูุฌุฏุงูู

## ๐ ูุฑุงูุจุฉ ุงููุธุงู

### ูู Supabase Dashboard:
- **Storage**: ูุฑุงูุจุฉ ุงุณุชููุงู ุงูุชุฎุฒูู
- **Database**: ูุฑุงูุจุฉ ุงุณุชููุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **Auth**: ุฅุฏุงุฑุฉ ุงููุตุงุฏูุฉ (ุฅุฐุง ูุทููุจุฉ)
- **Edge Functions**: ูุฑุงูุจุฉ ุงููุธุงุฆู (ุฅุฐุง ูุณุชุฎุฏูุฉ)

### ูู Replit:
- ูุฑุงูุจุฉ Console ููุฃุฎุทุงุก
- ูุฑุงูุจุฉ ุงุณุชููุงู ุงูููุงุฑุฏ
- ูุญุต Logs ุจุงูุชุธุงู

## ๐ ุตูุงูุฉ ุฏูุฑูุฉ

### ุชูุธูู ุงููููุงุช:
```javascript
// ุญุฐู ุงููููุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ
// ูููู ุชุดุบูููุง ููููุฉ ูุฌุฏููุฉ
const cleanupUnusedImages = async () => {
  // ููุฏ ุงูุชูุธูู ููุง
};
```

### ูุณุฎ ุงุญุชูุงุทูุฉ:
- Supabase ูููู ุจุงููุณุฎ ุงูุชููุงุฆู
- ูููุตุญ ุจูุณุฎ ุฅุถุงููุฉ ูููููุงุช ุงููููุฉ

## ๐ก ูุตุงุฆุญ ููุฃุฏุงุก

1. **ุถุบุท ุงูุตูุฑ**: ุงุณุชุฎุฏู ุฃุฏูุงุช ุถุบุท ุงูุตูุฑ ูุจู ุงูุฑูุน
2. **ุชุญุณูู ุงูุฃุญุฌุงู**: ุญุฏุฏ ุฃุญุฌุงู ููุงุณุจุฉ ููุดุงุดุงุช ุงููุฎุชููุฉ
3. **ุงูุชุฎุฒูู ุงููุคูุช**: ุงุณุชุฎุฏู CDN ูุชุณุฑูุน ุชุญููู ุงูุตูุฑ
4. **ูุฑุงูุจุฉ ุงูุงุณุชููุงู**: ุฑุงูุจ ุงุณุชููุงู ุงูุชุฎุฒูู ุดูุฑูุงู

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูู ุญุงูุฉ ูุงุฌูุช ูุดุงูู:
1. ุชุญูู ูู Logs ูู Replit Console
2. ุชุญูู ูู Supabase Dashboard
3. ุฑุงุฌุน ูุฐุง ุงูุฏููู ูุฑุฉ ุฃุฎุฑู
4. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช Secrets

---

**ููุงุญุธุฉ**: ูุฐุง ุงูุฅุนุฏุงุฏ ูุญุงูุธ ุนูู ุฌููุน ุงููุธุงุฆู ุงูููุฌูุฏุฉ ูุณุจูุงู ููุถูู ุฅูููุง ุฅููุงููุฉ ุฑูุน ูุชุฎุฒูู ุงูุตูุฑ ูู Supabase ุจุดูู ุขูู ูููุธู.